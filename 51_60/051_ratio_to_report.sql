--051 데이터 분석 함수로 비율 출력 (RATIO_TO_REPORT)
--부서 번호가 20번인 사원들의 사원 번호, 이름, 월급을 출력하고
-- 20번 부서 번호 내에서 자신의 월급이 어떻게 되는지 출력 
SELECT empno, ename, sal, RATIO_TO_REPORT(sal) OVER () as 비율
    FROM emp
    WHERE deptno = 20;

-- 출력 예시
--7566	JONES	2975	0.2735632183908045977011494252873563218391
--7902	FORD	3000	0.2758620689655172413793103448275862068966
--7369	SMITH	800	0.0735632183908045977011494252873563218391
--7788	SCOTT	3000	0.2758620689655172413793103448275862068966
--7876	ADAMS	1100	0.1011494252873563218390804597701149425287

-- 확인 ①
-- 사원번호가 20번인 사원들의 월급 합계
SELECT SUM(sal)
    FROM emp
    WHERE deptno = 20;

-- 출력 예시
-- 10875

-- 확인 ②
-- 비율 확인
SELECT 2975 / 10875
    FROM DUAL;
    
-- 출력 예시 
-- 0.2735632183908045977011494252873563218391

-- 확인 ③
-- 비교 비율과 확인해보기
SELECT empno, ename, sal, RATIO_TO_REPORT(sal) OVER() as 비율,
                                    SAL/SUM(sal) OVER() as "비교 비율"
    FROM emp
    WHERE deptno = 20;
    
-- 출력 예시
--7566	JONES	2975	0.2735632183908045977011494252873563218391	0.2735632183908045977011494252873563218391
--7902	FORD	3000	0.2758620689655172413793103448275862068966	0.2758620689655172413793103448275862068966
--7369	SMITH	800	0.0735632183908045977011494252873563218391	0.0735632183908045977011494252873563218391
--7788	SCOTT	3000	0.2758620689655172413793103448275862068966	0.2758620689655172413793103448275862068966
--7876	ADAMS	1100	0.1011494252873563218390804597701149425287	0.1011494252873563218390804597701149425287

-- 20번 부서 번호인 사원들의 월급을 20번 부서 번호인 사원들의 전체 월급으로 나누어 출력
-- RATIO_TO_REPORT(sal)의 결과와 동일하게 출력
